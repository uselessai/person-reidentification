<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js" integrity="sha512-JPcRR8yFa8mmCsfrw4TNte1ZvF1e3+1SdGMslZvmrzDYxS69J7J49vkFL8u6u8PlPJK+H3voElBtUCzaXj+6ig==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
  </head>
  <body>
    <canvas id="myChart"></canvas>
    <script>
  Chart.register(ChartDataLabels);
  const data = {
  datasets: [[
    {
      label: 'Dataset 1',
      backgroundColor: ['#AAA'],
      data: [10],
      URL: ["www.example1.com"],
      index: Math.floor(Math.random() * 1000), // número aleatorio entre 0 y 999
      hoverBackgroundColor: "blue"
    },
    {
      label: 'Dataset 2',
      backgroundColor: ['green'],
      data: [20],
      URL: ["www.example2.com"],
      index: Math.floor(Math.random() * 1000) // número aleatorio entre 0 y 999
    },
    {
      label: 'Dataset 3',
      backgroundColor: ['blue'],
      data:[30],
      URL: ["www.example3.com"],
      index: Math.floor(Math.random() * 1000) // número aleatorio entre 0 y 999
    }],
    [{
      label: 'Dataset 4',
      backgroundColor: ['yellow'],
      data:  [15],
      URL: ["www.example4.com"],
      index: Math.floor(Math.random() * 1000) // número aleatorio entre 0 y 999
    },{
      label: 'Dataset 5',
      backgroundColor: ['pink'],
      data:  [14],
      URL: ["www.example5.com"],
      index: Math.floor(Math.random() * 1000) // número aleatorio entre 0 y 999
    }],
    [{
      label: 'Dataset 6',
      backgroundColor: ['white'],
      data:  [15],
      URL: ["www.example4.com"],
      index: Math.floor(Math.random() * 1000) // número aleatorio entre 0 y 999
    },{
      label: 'Dataset 7',
      backgroundColor: ['purple'],
      data:  [14],
      URL: ["www.example5.com"],
      index: Math.floor(Math.random() * 1000) // número aleatorio entre 0 y 999
    }]
  ]
};


 ctx = document.getElementById('myChart').getContext('2d');
 myChart = new Chart(ctx, {
  type: 'pie', //doughnut or pie
  data: {
    datasets: data.datasets.map(function(dataset) {
      return {
        backgroundColor: dataset.map(function(d) { return d.backgroundColor; }),
        data: dataset.map(function(d) { return d.data; }),
        labels: dataset.map(function(d) { return d.label; }),
        urls: dataset.map(function(d) { return d.URL; }),
        //hoverBackgroundColor:  dataset.map(function(d) { return d.hoverBackgroundColor; }),
     
      };
    })
  },
  
  options: {
    plugins: {
      datalabels: {
      color: 'white',
      align: 'center',
      formatter: function(value, context) {
        return data.datasets[context.datasetIndex][context.dataIndex].label + ': \n ' + data.datasets[context.datasetIndex][context.dataIndex].URL;
        
      }
    },
      tooltip: {
        callbacks: {
          label: function(context) {
           
            console.log (context)
            console.log (context.datasetIndex)
            console.log (context.dataIndex)
            label = data.datasets[context.datasetIndex][context.dataIndex].label;
            console.log (label)
            return label + ': ' + context.formattedValue;
          }
        }
      }
    },
    showTooltips: true,
    responsive: true,
    onClick: function(e, item) {
        if (item.length) {
            console.log (item)
            console.log (item[0].datasetIndex) // indica nivel del pastel
            console.log (item[0].index) // indica dentro del nivel la seccion
            console.log (data.datasets[item[0].datasetIndex][item[0].index].URL)
            // window.open("www.google.es", "_blank");
        }
    },
  
  
    // Core options
    aspectRatio: 4 / 3,
    cutoutPercentage: 32,
    layout: {
      padding: 32
    },
    elements: {
      line: {
        fill: false
      },
      point: {
        hoverRadius: 7,
        radius: 5
      }
    }
  },
  
});

    

     






















    </script>
  </body>
</html>


